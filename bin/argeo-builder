#!/bin/bash

if [ -z "$JAVA_HOME" ]; then
	export JAVA_HOME=/usr/lib/jvm/java-1.6.0
fi  
JAVA=$JAVA_HOME/bin/java

function argeo_builder_variables() {
	export ARTIFACT_DIR=$1
	export ARTIFACT=${ARTIFACT_DIR##*/}
	export GROUP_DIR=$(dirname "$ARTIFACT_DIR")
	export GROUP=${GROUP_DIR##*/}
	export SOURCE_DIR=${ARTIFACT_DIR/specs/sources}
	export BUILD_DIR=${ARTIFACT_DIR/specs/build}
	export ROOT_DIR=`cd $ARTIFACT_DIR/../../.. && pwd`
	export CACHE_BASE=$ROOT_DIR/cache
	CACHE_DIR=${GROUP_DIR/specs/cache}
}

function argeo_builder_download_eclipse() {
	MIRROR=http://ftp.halifax.rwth-aachen.de/eclipse
	FILE=$1
	URL=$MIRROR$FILE
	mkdir -p $SOURCE_DIR
	(cd $SOURCE_DIR && wget --timestamping $URL)
}

function argeo_builder_download_apache() {
	MIRROR=http://apache.openmirror.de
	FILE=$1
	URL=$MIRROR$FILE
	mkdir -p $SOURCE_DIR
	(cd $SOURCE_DIR && wget --timestamping $URL)
}

function run_ant() {
	$JAVA -jar $CACHE_BASE/bootstrap/ant-launcher.jar $1
}

function push_to_cache() {
	mkdir -p $CACHE_DIR
	cp -v $1 $CACHE_DIR
}

function reset_dir() {
	rm -rf $1
	mkdir -p $1
}

